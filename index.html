<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Ficha de Cliente</title>
    <style>
        /* CSS para Estilização do Formulário e da Impressão */
        @import url('https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&family=Roboto:wght@400;500;700&display=swap');

        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f4f7f6;
            color: #333;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }

        .container {
            width: 100%;
            max-width: 800px;
            background: #fff;
            padding: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-radius: 8px;
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 25px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            font-weight: 900;
            margin-bottom: 8px;
            color: #555;
        }

        /* SELETOR ATUALIZADO PARA INCLUIR TEXTAREA */
        input[type="text"],
        input[type="number"],
        select,
        textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            font-size: 16px;
            font-family: 'Roboto', sans-serif; /* Garante a mesma fonte */
        }
        
        .plan-group {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 10px;
        }

        button {
            width: 100%;
            padding: 15px;
            background-color: #27ae60;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin-top: 15px;
        }

        button:hover {
            background-color: #229954;
        }

        #output {
            display: none;
        }
        
        @media print {
            body {
                background-color: #fff;
                color: #000;
                margin: 40px 25px; 
            }

            .container {
                display: none; 
            }

            #output {
                display: block; 
                font-family: 'Roboto Mono', monospace;
                font-size: 12pt;
                line-height: 1.4; /* Aumentado para melhor legibilidade */
                width: 100%;
            }

            #output h2 {
                text-align: center;
                font-size: 12pt;
                font-weight: 700;
                color: #000;
                background: none;
                border-bottom: 2px solid #333;
                padding-bottom: 10px;
                margin-bottom: 20px; /* Aumentado espaçamento */
            }

            .output-line {
                margin-bottom: 8px;
                padding-bottom: 8px;
                border-bottom: 1px solid #eee;
            }

            .output-line span {
                font-weight: 700;
                margin-right: 8px;
            }
            
            .output-line .data {
                font-weight: 400;
                display: inline; 
            }

            .checklist-item {
                font-size: 11pt;
                margin-bottom: 6px;
            }
            
            hr.dashed {
                border: none;
                border-top: 1px dashed #888;
                margin: 25px 0;
            }
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Gerador de Ficha de Atendimento</h1>
        <form id="customerForm">
            <div class="form-group">
                <label for="tipo">TIPO:</label>
                <select id="tipo" name="tipo">
                    <option value="CLIENTE NOVO">CLIENTE NOVO</option>
                    <option value="AMPLIAÇÃO DE BANDA">AMPLIAÇÃO DE BANDA</option>
                    <option value="REATIVAÇÃO DO ACESSO">REATIVAÇÃO DO ACESSO</option>
                </select>
            </div>

            <div class="form-group">
                <label for="nome">NOME:</label>
                <input type="text" id="nome" name="nome" required>
            </div>

            <div class="form-group">
                <label for="cpf">CPF:</label>
                <input type="text" id="cpf" name="cpf" placeholder="000.000.000-00" required>
            </div>

            <div id="plan-fields"></div>

            <div class="form-group">
                <label for="roteador">ROTEADOR EM COMODATO?</label>
                <select id="roteador" name="roteador">
                    <option value="SIM">SIM</option>
                    <option value="NÃO">NÃO</option>
                </select>
            </div>

            <div class="form-group">
                <label for="kit_ftth">KIT FTTH EM COMODATO?</label>
                <select id="kit_ftth" name="kit_ftth">
                    <option value="SIM">SIM</option>
                    <option value="NÃO">NÃO</option>
                </select>
            </div>

            <div class="form-group">
                <label for="termos_assinados">TERMOS FORAM ASSINADOS?</label>
                <select id="termos_assinados" name="termos_assinados">
                    <option value="DIGITALMENTE">DIGITALMENTE</option>
                    <option value="MANUALMENTE">MANUALMENTE</option>
                </select>
            </div>

            <div class="form-group">
                <label for="documentos_anexados">DOCUMENTOS PESSOAIS ANEXADOS?</label>
                <select id="documentos_anexados" name="documentos_anexados">
                    <option value="SIM">SIM</option>
                    <option value="NÃO">NÃO</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="observacoes">OBSERVAÇÕES (OPCIONAL):</label>
                <textarea id="observacoes" name="observacoes" rows="3" placeholder="Se necessário, adicione aqui qualquer observação relevante..."></textarea>
            </div>

            <hr>
            <h3>CHECKLIST FINAL</h3>
            <div class="form-group">
                <input type="checkbox" id="check_contrato" name="check_contrato">
                <label for="check_contrato">TERMOS DE ADESÃO E FIDELIDADE ASSINADOS CORRETAMENTE?</label>
            </div>
            <div class="form-group">
                <input type="checkbox" id="check_boletos" name="check_boletos">
                <label for="check_boletos">BOLETOS 2026 GERADOS E IMPRESSOS?</label>
            </div>
            <div class="form-group">
                <input type="checkbox" id="check_anotacoes" name="check_anotacoes">
                <label for="check_anotacoes">INFORMAÇÕES ADICIONADAS EM ANOTAÇÕES?</label>
            </div>

            <button type="button" id="generateBtn">Gerar para Impressão</button>
        </form>
    </div>

    <div id="output"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const tipoSelect = document.getElementById('tipo');
            const planFieldsContainer = document.getElementById('plan-fields');
            const generateBtn = document.getElementById('generateBtn');
            const outputContainer = document.getElementById('output');
            const cpfInput = document.getElementById('cpf');

            function updatePlanFields() {
                const selectedType = tipoSelect.value;
                let html = '';

                if (selectedType === 'AMPLIAÇÃO DE BANDA') {
                    html = `
                        <div class="form-group">
                            <label>PLANO ANTIGO:</label>
                            <div class="plan-group">
                                <input type="text" id="plano_antigo" placeholder="Ex: 100MBPS" required>
                                <input type="number" id="valor_antigo" placeholder="Valor (Ex: 79,90)" step="0.01" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>PLANO NOVO:</label>
                            <div class="plan-group">
                                <input type="text" id="plano_novo" placeholder="Ex: 300MBPS" required>
                                <input type="number" id="valor_novo" placeholder="Valor (Ex: 89,90)" step="0.01" required>
                            </div>
                        </div>
                    `;
                } else {
                    html = `
                        <div class="form-group">
                            <label>PLANO DO CLIENTE:</label>
                             <div class="plan-group">
                                <input type="text" id="plano" placeholder="Ex: 300MBPS" required>
                                <input type="number" id="valor" placeholder="Valor (Ex: 89,90)" step="0.01" required>
                            </div>
                        </div>
                    `;
                }
                planFieldsContainer.innerHTML = html;
            }

            cpfInput.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                value = value.replace(/(\d{3})(\d)/, '$1.$2');
                value = value.replace(/(\d{3})(\d)/, '$1.$2');
                value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
                e.target.value = value.slice(0, 14);
            });

            function generateAndPrint() {
                const tipo = document.getElementById('tipo').value;
                const nome = document.getElementById('nome').value;
                const cpf = document.getElementById('cpf').value;
                
                // NOVO: Captura o valor das observações
                const observacoes = document.getElementById('observacoes').value;
                
                let planoLabel = 'PLANO';
                let planoInfo = '';
                if (tipo === 'AMPLIAÇÃO DE BANDA') {
                    planoLabel = 'PLANOS';
                    const planoAntigo = document.getElementById('plano_antigo').value;
                    const valorAntigo = parseFloat(document.getElementById('valor_antigo').value).toFixed(2).replace('.', ',');
                    const planoNovo = document.getElementById('plano_novo').value;
                    const valorNovo = parseFloat(document.getElementById('valor_novo').value).toFixed(2).replace('.', ',');
                    planoInfo = `ANTIGO: ${planoAntigo} - R$${valorAntigo} <br> NOVO: ${planoNovo} - R$${valorNovo}`;
                } else {
                    const plano = document.getElementById('plano').value;
                    const valor = parseFloat(document.getElementById('valor').value).toFixed(2).replace('.', ',');
                    planoInfo = `${plano} - R$${valor}`;
                }
                
                // NOVO: Cria o HTML para as observações apenas se houver texto
                let obsHTML = '';
                if (observacoes.trim() !== '') {
                    obsHTML = `<div class="output-line"><span>OBSERVAÇÕES:</span> <div class="data">${observacoes.toUpperCase()}</div></div>`;
                }

                let outputHTML = `
                    <h2>TIPO: ${tipo}</h2>
                    <div class="output-line"><span>NOME:</span> <div class="data">${nome.toUpperCase()}</div></div>
                    <div class="output-line"><span>CPF:</span> <div class="data">${cpf}</div></div>
                    <div class="output-line"><span>${planoLabel}:</span> <div class="data">${planoInfo.toUpperCase()}</div></div>
                    <div class="output-line"><span>ROTEADOR EM COMODATO:</span> <div class="data">${document.getElementById('roteador').value}</div></div>
                    <div class="output-line"><span>KIT FTTH EM COMODATO:</span> <div class="data">${document.getElementById('kit_ftth').value}</div></div>
                    <div class="output-line"><span>ASSINATURA TERMOS:</span> <div class="data">${document.getElementById('termos_assinados').value}</div></div>
                    <div class="output-line"><span>DOCUMENTOS ANEXADOS:</span> <div class="data">${document.getElementById('documentos_anexados').value}</div></div>
                    
                    ${obsHTML}
                    
                    <hr class="dashed">
                    
                    <div class="checklist-item">
                        [${document.getElementById('check_contrato').checked ? 'X' : ' '}] CONTRATO VERIFICADO E ASSINADO CORRETAMENTE
                    </div>
                    <div class="checklist-item">
                        [${document.getElementById('check_boletos').checked ? 'X' : ' '}] BOLETOS 2026 GERADOS E IMPRESSOS
                    </div>
                    <div class="checklist-item">
                        [${document.getElementById('check_anotacoes').checked ? 'X' : ' '}] INFORMAÇÕES ADICIONADAS NO CAMPO ANOTAÇÕES DO SGP
                    </div>
                `;

                outputContainer.innerHTML = outputHTML;
                window.print();
            }

            tipoSelect.addEventListener('change', updatePlanFields);
            generateBtn.addEventListener('click', () => {
                if (document.getElementById('customerForm').checkValidity()) {
                    generateAndPrint();
                } else {
                    alert('Por favor, preencha todos os campos obrigatórios.');
                    document.getElementById('customerForm').reportValidity();
                }
            });

            updatePlanFields();
        });
    </script>
</body>
</html>